import{R as c}from"./entry-index-Cq13IMyc.js";import{t as u}from"./chunk-index-CSMgxAiP.js";async function l(){try{const e=await fetch("/api/admin/settings");if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=await e.json(),{CreatedAt:a,UpdatedAt:o,id:g,...r}=t.data;return r}catch(e){throw console.error("Failed to fetch settings:",e),e}}async function d(e){try{const t=await fetch("/api/admin/settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)try{const a=await t.json();throw console.log("Error response data:",a.message),new Error(`${a.message}`)}catch(a){throw a}}catch(t){throw console.error("Failed to update settings:",t),t}}async function y(e,t){try{await d(e),u.success(t("settings.settings_saved"))}catch(a){throw u.error(t("settings.settings_save_failed")+": "+a),a}}async function p(e,t,a){const o={...a,[e]:t};return d(o)}function _(){const[e,t]=c.useState({sitename:"",description:"",allow_cors:!1,geo_ip_enabled:!1,geo_ip_provider:"",o_auth_client_id:"",o_auth_client_secret:"",o_auth_enabled:!1,custom_head:"",CreatedAt:"",UpdatedAt:""}),[a,o]=c.useState(!1),[g,r]=c.useState(null);return c.useEffect(()=>{(async()=>{o(!0),r(null);try{const s=await l();t(s)}catch(s){r(s instanceof Error?s.message:"Failed to fetch settings")}finally{o(!1)}})()},[]),{settings:e,loading:a,error:g,updateSetting:async(n,s)=>{try{await p(n,s,e),t(i=>({...i,[n]:s}))}catch(i){throw r(i instanceof Error?i.message:`Failed to update ${String(n)}`),i}},updateMultipleSettings:async n=>{try{const s={...e,...n};await d(s),t(s)}catch(s){throw r(s instanceof Error?s.message:"Failed to update settings"),s}},refetch:async()=>{const n=await l();t(n)}}}export{y as a,_ as u};
