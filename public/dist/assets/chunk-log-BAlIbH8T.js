import{R as x,r as P,j as e,a as V}from"./entry-index-Cq13IMyc.js";import{T as C,a as R,b as L,c as p,d as $,e as b}from"./chunk-table-BS5X1aPI.js";import{c as z}from"./chunk-createLucideIcon-SgBSd_zz.js";import{P as _}from"./chunk-plus-yY1l5HUY.js";import{p as S}from"./chunk-flex-D_qeScnl.js";import{o as D}from"./chunk-icon-button-8RHoNX6f.js";import{u as B,c as k}from"./chunk-text-field-BPsisRj1.js";import{u as U}from"./chunk-useTranslation-DT6f2-nl.js";import{s as H,n as A,p as F,g as q,D as G}from"./chunk-dialog-ChtOFG_l.js";import{o as v}from"./chunk-button-BTrNb_zO.js";import"./chunk-react-vendor-Csw2ODfV.js";import"./chunk-utils-bRKmu4jq.js";import"./chunk-internal-BM6wX41l.js";import"./chunk-require-react-element-DaU34sMa.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M5 12h14",key:"1ays0h"}]],K=z("minus",J);function O({defaultValue:u,onChange:n,min:a=1,max:r=100,...g}){const c=Math.max(a,Math.min(r,u!==void 0?u:a)),[o,j]=x.useState(String(c));P.useEffect(()=>{if(u===void 0)return;const t=Math.max(a,Math.min(r,u));j(String(t)),n(t)},[u,a,r,n]);const N=t=>{const i=Math.max(a,Math.min(r,t));j(String(i)),n(i)},f=t=>{const i=t.target.value.trim();j(i);const h=Number(i);isNaN(h)||h>=a&&h<=r&&n(h)},y=()=>{const t=Number(o);if(o===""){j(String(a)),n(a);return}const i=Math.max(a,Math.min(r,t));j(String(i)),n(i)},d=Number(o)||a,l=d<=a,M=d>=r;return e.jsxs(S,{align:"center",gap:"2",children:[e.jsx(D,{variant:"soft",radius:"full",size:"1",onClick:()=>N(d-1),disabled:l,"aria-label":"decrement",children:e.jsx(K,{size:"16"})}),e.jsxs(B,{type:"text",inputMode:"numeric",value:o,onChange:f,onBlur:y,style:{width:"4rem",textAlign:"center"},...g,children:[e.jsx(k,{}),e.jsx(k,{})]}),e.jsx(D,{variant:"soft",radius:"full",size:"1",onClick:()=>N(d+1),disabled:M,"aria-label":"increment",children:e.jsx(_,{size:"16"})})]})}const oe=()=>{const[u,n]=x.useState(!0),[a,r]=x.useState([]),[g,w]=x.useState(null),[c,o]=x.useState(1),[j,N]=x.useState(1),[f,y]=x.useState(10),[d]=U();x.useEffect(()=>{(async()=>{n(!0);try{const m=await fetch(`/api/admin/logs?limit=${f}&page=${c}`);if(!m.ok)throw new Error("Failed to fetch logs");const T=await m.json();r(T.data.logs),N(T.data.total)}catch(m){w(m instanceof Error?m.message:"Unknown error")}finally{n(!1)}})()},[c]);const l=Math.ceil(j/f),M=1;let t=[];const i=Math.max(c-M,1),h=Math.min(c+M,l),E=i>2,I=h<l-1;if(t.push(1),E)t.push("...");else for(let s=2;s<i;s++)t.push(s);for(let s=i;s<=h;s++)s>1&&s<l&&t.push(s);if(I)t.push("...");else for(let s=h+1;s<l;s++)t.push(s);return l>1&&t.push(l),u?e.jsx(V,{}):g?e.jsxs("div",{children:["Error: ",g]}):e.jsxs("div",{className:"flex flex-col gap-2 p-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold",children:d("logs.title")}),e.jsxs("div",{className:"flex items-center gap-2",children:["Limit",e.jsx(O,{defaultValue:f,onChange:y,min:1,max:100})]})]}),e.jsx("div",{className:"rounded-lg overflow-hidden",children:e.jsxs(C,{children:[e.jsx(R,{children:e.jsxs(L,{children:[e.jsx(p,{children:"ID"}),e.jsx(p,{children:"IP"}),e.jsx(p,{children:"Type"}),e.jsx(p,{children:"Message"}),e.jsx(p,{children:"Time"})]})}),e.jsx($,{children:a.map(s=>e.jsxs(L,{children:[e.jsx(b,{children:e.jsxs(H,{children:[e.jsx(A,{children:e.jsx("label",{className:"hover:underline font-bold",children:s.id})}),e.jsxs(F,{children:[e.jsx(q,{children:d("log.title")}),e.jsxs(S,{direction:"column",gap:"1",children:[e.jsx("label",{className:"font-bold",children:"ID"}),e.jsx("label",{className:"text-sm",children:s.id}),e.jsx("label",{className:"font-bold",children:"IP"}),e.jsx("label",{className:"text-sm",children:s.ip}),e.jsx("label",{className:"font-bold",children:"UUID"}),e.jsx("label",{className:"text-sm",children:s.uuid}),e.jsx("label",{className:"font-bold",children:"Type"}),e.jsx("label",{className:"text-sm",children:s.msg_type}),e.jsx("label",{className:"font-bold",children:"Message"}),e.jsx("label",{className:"text-sm",children:s.message}),e.jsx("label",{className:"font-bold",children:"Time"}),e.jsx("label",{className:"text-sm",children:new Date(s.time).toLocaleString()})]}),e.jsx(S,{justify:"end",children:e.jsx(G,{children:e.jsx(v,{variant:"soft",children:d("close")})})})]})]})}),e.jsx(b,{children:s.ip}),e.jsx(b,{children:s.msg_type}),e.jsx(b,{children:s.message.length>75?`${s.message.slice(0,75)}...`:s.message}),e.jsx(b,{children:new Date(s.time).toLocaleString()})]},s.id))})]})}),e.jsxs("div",{className:"flex justify-center items-center space-x-2 mt-4 gap-2",children:[e.jsx(v,{disabled:c===1,onClick:()=>o(s=>Math.max(1,s-1)),children:"<"}),t.map((s,m)=>typeof s=="number"?e.jsx(v,{variant:s===c?"solid":"soft",onClick:()=>o(s),children:s},m):e.jsx("span",{className:"px-2",children:"..."},m)),e.jsx(v,{disabled:c===l,onClick:()=>o(s=>Math.min(l,s+1)),children:">"})]})]})};export{oe as default};
